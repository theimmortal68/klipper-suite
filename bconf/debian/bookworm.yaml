---
mmdebstrap:
  architectures:
    - arm64
  cleanup-hooks:
    - cp /dev/null "$1/etc/hostname"
    - if test -f "$1/etc/resolv.conf"; then cp /dev/null "$1/etc/resolv.conf"; fi
  components:
    - main
  customize-hooks:
    # Update APT cache to update command-not-found database
    - chroot "$1" apt-get update
  keyrings:
    - /usr/share/keyrings/debian-archive-keyring.gpg
  mode: unshare
  mirrors:
    - deb http://deb.debian.org/debian bookworm main contrib non-free non-free-firmware
    - deb http://deb.debian.org/debian-security bookworm-security main contrib non-free non-free-firmware
    - deb http://deb.debian.org/debian bookworm-updates main contrib non-free non-free-firmware
  aptopts:
    - APT::Install-Suggests "false"
    - APT::Install-Recommends "false"
    - Debug::pkgProblemResolver "1"
    - Acquire::Retries "3"
    - Acquire::http::No-Cache "true"
    - APT::Cache-Limit "100000000"
    - DPkg::Lock::Timeout "600"
  dpkgopts:
    - path-exclude=/usr/share/man/*
    - path-include=/usr/share/man/man[1-9]/*
    - path-exclude=/usr/share/locale/*
    - path-include=/usr/share/locale/locale.alias
    - path-exclude=/usr/share/doc/*
    - path-include=/usr/share/doc/*/copyright
    - path-include=/usr/share/doc/*/changelog.Debian.*
    - path-exclude=/usr/share/{doc,info,man,omf,help,gnome/help}/*
    - path-exclude=/usr/share/lintian/*
  packages:
    # install packages from priority important (aptitude search '~pimportant' -F'%p')
    - adduser
    - debian-archive-keyring
    - fdisk
    - gpgv
    - ifupdown
    - init
    - iproute2
    - iputils-ping
    - isc-dhcp-client
    - kmod
    - less
    - logrotate
    - nano
    - netbase
    - procps
    - rsyslog
    - sensible-utils
    - udev
    - whiptail
    # install packages from priority standard (aptitude search '~pstandard' -F'%p')
    - bash-completion
    - bind9-dnsutils
    - bind9-host
    - dbus
    - file
    - libpam-systemd  # recommended by systemd and needed to not run into https://bugs.debian.org/751636
    - locales
    - lsof
    - man-db
    - manpages
    - openssh-client
    - pciutils
    - traceroute
    - wget
    - xz-utils
    # basic stuff
    - command-not-found
    - console-data
    - htop
    - kbd  # for loadkeys
    - networkmanager 
    - openssh-server
    - psmisc  # for fuser, killall, etc.
    - rsync
    - sudo
    - usbutils  # for lsusb
    - vim
    - wireless-tools
    - wpasupplicant
  suite: bookworm 
  target: root.tar.xz
  variant: minbase
